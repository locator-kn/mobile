<ion-view view-title="Suchergebnisse" ng-controller="TripOverviewCtrl as toc">
    <ion-nav-buttons side="right">
        <!--<p class="location-finish" ng-click="$ionicGoBack()">Suchergebnis</p>-->
        <button class="button button-icon ion-compose" ng-click="toc.filterModalShow()"></button>
    </ion-nav-buttons>
    <ion-content class="background-color-grey">
        <ion-list class="list">
            <ion-item ng-repeat="result in toc.results">
                <li>
                    <div>
                        <div class="item trip-title-in-results">{{result.title}}</div>

                        <div ng-click="toc.showTripDetail(result._id, result.userid)">
                            <!-- for each pictures-->
                            <ion-slide-box ng-if="toc.numberOfElelementsIn(result.locations) !== 1"
                                           on-slide-changed="slideHasChanged($index)">
                                <ion-slide ng-repeat="location in result.locations">
                                    <div class="trip-text-location"
                                         ui-sref="tab.search-result-locations({locationSourceId:result._id})">
                                        Location
                                        <img class="image-all-locations" src="/images/icons/alle_locations_weiss.png">
                                    </div>
                                    <div class="image-container"
                                         style="background-image: url({{toc.webPath}}{{location.picture + '?size=mobile'}});background-size: cover">
                                    </div>
                                </ion-slide>
                            </ion-slide-box>
                            <div ng-if="toc.numberOfElelementsIn(result.locations) === 1">
                                <div ng-repeat="location in result.locations">
                                    <div class="trip-text-location"
                                         ui-sref="tab.search-result-locations({locationSourceId:result._id})">
                                        Location
                                        <img class="image-all-locations" src="/images/icons/alle_locations_weiss.png">
                                    </div>
                                    <div class="image-container"
                                         style="background-image: url({{toc.webPath}}{{location.picture + '?size=mobile'}});background-size: cover">
                                    </div>
                                </div>
                            </div>
                        </div>
                        <ul>
                            <div ng-click="toc.showTripDetail(result._id, result.userid)">
                                <li class="item">
                                    <div class="text-bold">{{result.title}}</div>
                                    <label>von </label>
                                    <label class="text-bold">{{result.username || 'anonym'}}</label>
                                </li>
                                <li class="item" ng-if="result.start_date && result.end_date">
                                    <label class="text-bold">{{toc.formatDate(result.start_date)}}</label>
                                    <label>bis</label>
                                    <label class="text-bold">{{toc.formatDate(result.end_date)}}</label>
                                </li>
                                <li class="item">
                                    <label>
                                        <label ng-if="result.days" class="text-bold">{{result.days}}</label>
                                        <label>{{result.days === 1 ? 'Tag' : 'Tage'}}</label>
                                        <label ng-if="result.days && result.persons" class="text-bold">|</label>
                                        <label class="text-bold">{{result.persons}} </label>
                                        <label ng-if="result.persons">{{result.persons === 1 ? 'Person' :
                                            'Personen'}}</label>
                                        <label ng-if="result.persons || result.locations" class="text-bold">|</label>
                                        <label class="text-bold">{{toc.numberOfElelementsIn(result.locations)}}</label>
                                        <label ng-if="result.locations">
                                            {{toc.numberOfElelementsIn(result.locations) === 1 ? 'Location' :
                                            'Locations'}}
                                        </label>
                                    </label>
                                </li>
                                <li class="item mood-container" ng-if="result.moods">
                                    <div ng-repeat="mood in result.moods">
                                        <div ng-repeat="availableMood in toc.moods |filter:mood">
                                            <img class="result-mood" ng-src="./images/icons/{{availableMood.icon}}">
                                            <label class="mood-title">{{availableMood.title}}</label>
                                        </div>
                                    </div>
                                </li>
                                <li class="item" ng-if="result.accommodation">
                                    <label>mit Übernachtung</label>
                                </li>
                            </div>
                            <li class="item trip-options">
                                <img class="icon icon-small" ng-src="./images/icons/ansehen_weiss.png"
                                     ng-click="toc.showTripDetail(result._id, result.userid)">
                                <img class="icon" ng-src="./images/icons/alle_locations_weiss.png"
                                     ui-sref="tab.search-result-locations({locationSourceId:result._id})">
                                <img class="icon" ng-src="./images/icons/messenger_weiss.png">

                                <label class="user">
                                    <label class="dekotext">erstellt von </label>
                                    <label class="name">{{result.username || 'anonym'}}</label>
                                </label>
                            </li>
                        </ul>
                    </div>
                </li>
            </ion-item>
        </ion-list>
    </ion-content>
    <script id="templates/modals/search-filter-modal.html" type="text/ng-template">
        <ion-modal-view>
            <ion-header-bar class="bar bar-header bar-positive">
                <h1 class="title">Filter</h1>
                <button class="button button-clear button-primary" ng-click="toc.filterModal.hide()">Cancel</button>
            </ion-header-bar>
            <ion-content>
                <div>
                    <ul class="list">
                        <li class="item item-icon-right" ui-sref="tab.search-city">
                            {{toc.filterValues.queryParams.city.title || "Wo willst du hin?"}}&nbsp;
                            <i class="icon ion-chevron-right icon-accessory"></i>
                        </li>
                        <li class="item item-icon-right" ui-sref="tab.search-moods">
                            <span ng-if="!toc.filterValues.queryParams.moods">Wie soll es sein?</span>
                            <i class="icon ion-chevron-right icon-accessory"></i>

                            <div ng-if="toc.filterValues.queryParams.moods">
                                <img class="result-mood" ng-src="./images/icons/white/{{toc.filterValues.queryParams.moods.title.icon_white}}">
                                <label class="mood-title">{{toc.filterValues.queryParams.moods.title}}</label>
                            </div>
                        </li>
                        <li class="item">
                            Tage
                            <div class="select-elements">
                                <div class="circle" ng-repeat="day in toc.filterValues.availableDays"
                                     ng-click="toc.filterValues.queryParams.days=day.value"
                                     ng-class="{'circle-selected': toc.filterValues.queryParams.days == day.value}">{{day.title}}
                                </div>
                            </div>
                        </li>
                        <li class="item">
                            Personen
                            <div class="select-elements">
                                <div class="circle" ng-repeat="person in toc.filterValues.availablePersons"
                                     ng-click="toc.filterValues.queryParams.persons=person.value"
                                     ng-class="{'circle-selected': toc.filterValues.queryParams.persons == person.value}">{{person.title}}
                                </div>
                            </div>
                        </li>
                        <label class="item item-input">
                            <span class="input-label">Zeitraum von</span>
                            <input  class="text-right"  type="date" ng-model="toc.filterValues.queryParams.start_date">
                        </label>
                        <label class="item item-input">
                            <span class="input-label">bis</span>
                            <input  class="text-right"  type="date" ng-model="toc.filterValues.queryParams.end_date">
                        </label>
                        <li class="item item-toggle">
                            Übernachtung
                            <label class="toggle toggle-dark toggle-assertive"
                                   ng-click="toc.filterValues.accommodation = ! toc.filterValues.sc.accommodation">
                                <input type="checkbox">

                                <div class="track">
                                    <div class="handle"></div>
                                </div>
                            </label>
                        </li>
                    </ul>
                </div>
            </ion-content>
        </ion-modal-view>
    </script>
</ion-view>
